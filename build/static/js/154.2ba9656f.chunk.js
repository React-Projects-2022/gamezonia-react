"use strict";(self.webpackChunkgamezonia_react=self.webpackChunkgamezonia_react||[]).push([[154],{4018:function(e,r,n){n.d(r,{P:function(){return s}});var t,a=n(168),s=(0,n(7261).Ps)(t||(t=(0,a.Z)(["\n  fragment UserObject on User {\n    id\n    name\n    lastname\n    email\n    registerDate @include(if: $include)\n    birthday @include(if: $include)\n    role\n    active\n    stripeCustomer\n  }\n"])))},2154:function(e,r,n){n.r(r),n.d(r,{default:function(){return P}});var t,a,s,i,o=n(1413),l=n(885),u=n(2791),c=n(168),d=n(7261),m=(0,d.Ps)(t||(t=(0,c.Z)(["\n  fragment ResultInfoObject on ResultInfo {\n    page\n    pages\n    total\n    itemsPage\n  }\n"]))),p=n(4018),g=(0,d.Ps)(a||(a=(0,c.Z)(["\n  query getLogin($email: String!, $password: String!, $include: Boolean!) {\n    login(email: $email, password: $password) {\n      status\n      message\n      token\n      user {\n        ...UserObject\n      }\n    }\n  }\n  ","\n"])),p.P),v=((0,d.Ps)(s||(s=(0,c.Z)(["\n  query usersList(\n    $include: Boolean!\n    $page: Int\n    $itemsPage: Int\n    $active: ActiveFilterEnum\n  ) {\n    users(page: $page, itemsPage: $itemsPage, active: $active) {\n      info {\n        ...ResultInfoObject\n      }\n      status\n      message\n      users {\n        ...UserObject\n      }\n    }\n  }\n  ","\n  ","\n"])),p.P,m),(0,d.Ps)(i||(i=(0,c.Z)(["\n  query meData($include: Boolean!) {\n    me {\n      status\n      message\n      user {\n        ...UserObject\n      }\n    }\n  }\n  ","\n"])),p.P),n(2336)),f=n(9648),h=n(184),b=function(e){var r=e.email,n=e.password,t=(0,v.a)(g,{variables:{email:r,password:n,include:!1}}),a=t.data,s=t.error,i=t.loading,o=(0,u.useContext)(f.I),c=(0,l.Z)(o,2),d=c[0],m=c[1];if(""!==d.displayName&&console.log(d.displayName),a&&a.login.status){console.log(a.login.token);var p={displayName:"Gamezonia",token:a.login.token,expiresIn:new Date((new Date).getTime()+864e5)};localStorage.setItem("session",JSON.stringify(p)),m(p),window.location.replace("/")}return(0,h.jsx)(h.Fragment,{children:i?(0,h.jsx)("p",{children:"Loading..."}):s?(0,h.jsx)("p",{children:s}):(0,h.jsx)("p",{className:"alert alert-danger",children:a.login.message})})},w=n(4259),y=(n(8694),/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/),P=function(){var e=(0,w.cI)({mode:"onChange"}),r=e.register,n=e.handleSubmit,t=e.formState.errors,a=(0,u.useState)({email:"",password:""}),s=(0,l.Z)(a,2),i=s[0],c=s[1],d=(0,u.useContext)(f.I),m=(0,l.Z)(d,1)[0];return""!==m.token&&!new Date(m.expiresIn).getTime()<(new Date).getTime()/1e3&&(console.log("Session OK"),window.location.replace("/")),(0,h.jsxs)("div",{className:"container mb-2",children:[(0,h.jsx)("h1",{children:"Login"}),""!==i.email?(0,h.jsx)(b,{email:i.email,password:i.password}):(0,h.jsx)("p",{children:"Haz click para iniciar sesi\xf3n"}),(0,h.jsxs)("form",{onSubmit:n((function(e){c({email:e.email,password:e.password})})),children:[(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),(0,h.jsx)("input",(0,o.Z)({autoFocus:!0,className:"form-control",defaultValue:"user@gamezonia.com",placeholder:"Input email address"},r("email",{required:"This field is required",pattern:{value:y,message:"Invalid email address"}}))),t.email&&(0,h.jsx)("p",{className:"validation alert alert-danger",children:t.email.message})," "]}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{htmlFor:"password",className:"form-label",children:"Password"}),(0,h.jsx)("input",(0,o.Z)({className:"form-control",type:"password",defaultValue:"123456",placeholder:"Input password"},r("password",{required:!0,minLength:6}))),t.password&&(0,h.jsx)("p",{className:"validation alert alert-danger",children:"This field is required and min length is 6 characters"})]}),(0,h.jsx)("input",{type:"submit",className:"btn btn-dark"})]})]})}},8694:function(){},2336:function(e,r,n){n.d(r,{a:function(){return m}});var t=n(9388),a=n(2791),s=n(5970),i=n(3651),o=n(9819),l=n(9484),u=n(8814),c=n(2364),d=n(5046);function m(e,r){var n,i=(0,a.useContext)((0,o.K)()),m=(0,d.x)(null===r||void 0===r?void 0:r.client),g=m.defaultOptions.watchQuery;(0,c.Vp)(e,c.n_.Query);var v,f=(0,a.useState)((function(){var n=p(e,r,g),t=null;return i.renderPromises&&(t=i.renderPromises.getSSRObservable(n)),t||(t=m.watchQuery(n),i.renderPromises&&i.renderPromises.registerSSRObservable(t,n)),i.renderPromises&&!1!==(null===r||void 0===r?void 0:r.ssr)&&!(null===r||void 0===r?void 0:r.skip)&&t.getCurrentResult().loading&&i.renderPromises.addQueryPromise({getOptions:function(){return p(e,r,g)},fetchData:function(){return new Promise((function(e){var r=t.subscribe({next:function(n){n.loading||(e(),r.unsubscribe())},error:function(){e(),r.unsubscribe()},complete:function(){e()}})}))}},(function(){return null})),t})),h=f[0],b=f[1],w=(0,a.useState)((function(){var e,n,t=h.getCurrentResult();return!t.loading&&r&&(t.error?null===(e=r.onError)||void 0===e||e.call(r,t.error):t.data&&(null===(n=r.onCompleted)||void 0===n||n.call(r,t.data))),t})),y=w[0],P=w[1],j=(0,a.useRef)({client:m,query:e,options:r,result:y,previousData:void 0,watchQueryOptions:p(e,r,g)});(0,a.useEffect)((function(){var n,t,a,i=p(e,r,g);if(j.current.client===m&&(0,s.D)(j.current.query,e))(0,s.D)(j.current.watchQueryOptions,i)||(h.setOptions(i).catch((function(){})),a=h.getCurrentResult(),j.current.watchQueryOptions=i);else{var o=m.watchQuery(i);b(o),a=o.getCurrentResult()}if(a){var l=j.current.result;l.data&&(j.current.previousData=l.data),P(j.current.result=a),!a.loading&&r&&(a.error?null===(n=r.onError)||void 0===n||n.call(r,a.error):a.data&&(null===(t=r.onCompleted)||void 0===t||t.call(r,a.data)))}Object.assign(j.current,{client:m,query:e})}),[h,m,e,r]),(0,a.useEffect)((function(){if(!i.renderPromises){var e=h.subscribe(r,(function n(t){var a,i,o=h.last;e.unsubscribe();try{h.resetLastResults(),e=h.subscribe(r,n)}finally{h.last=o}if(!t.hasOwnProperty("graphQLErrors"))throw t;var l=j.current.result;(l&&l.loading||!(0,s.D)(t,l.error))&&(P(j.current.result={data:l.data,error:t,loading:!1,networkStatus:u.I.error}),null===(i=null===(a=j.current.options)||void 0===a?void 0:a.onError)||void 0===i||i.call(a,t))}));return function(){return e.unsubscribe()}}function r(){var e,r,n=j.current.result,t=h.getCurrentResult();n&&n.loading===t.loading&&n.networkStatus===t.networkStatus&&(0,s.D)(n.data,t.data)||(n.data&&(j.current.previousData=n.data),P(j.current.result=t),t.loading||null===(r=null===(e=j.current.options)||void 0===e?void 0:e.onCompleted)||void 0===r||r.call(e,t.data))}}),[h,i.renderPromises,m.disableNetworkFetches]),v=(n=y).partial,y=(0,t._T)(n,["partial"]),!v||!(null===r||void 0===r?void 0:r.partialRefetch)||y.loading||y.data&&0!==Object.keys(y.data).length||"cache-only"===h.options.fetchPolicy||(y=(0,t.pi)((0,t.pi)({},y),{loading:!0,networkStatus:u.I.refetch}),h.refetch()),i.renderPromises&&!1!==(null===r||void 0===r?void 0:r.ssr)&&!(null===r||void 0===r?void 0:r.skip)&&y.loading&&h.setOptions(p(e,r,g)).catch((function(){})),Object.assign(j.current,{options:r}),(i.renderPromises||m.disableNetworkFetches)&&!1===(null===r||void 0===r?void 0:r.ssr)?y=j.current.result={loading:!0,data:void 0,error:void 0,networkStatus:u.I.loading}:((null===r||void 0===r?void 0:r.skip)||"standby"===(null===r||void 0===r?void 0:r.fetchPolicy))&&(y={loading:!1,data:void 0,error:void 0,networkStatus:u.I.ready}),y.errors&&y.errors.length&&(y=(0,t.pi)((0,t.pi)({},y),{error:y.error||new l.c({graphQLErrors:y.errors})}));var k=(0,a.useMemo)((function(){return{refetch:h.refetch.bind(h),fetchMore:h.fetchMore.bind(h),updateQuery:h.updateQuery.bind(h),startPolling:h.startPolling.bind(h),stopPolling:h.stopPolling.bind(h),subscribeToMore:h.subscribeToMore.bind(h)}}),[h]);return(0,t.pi)((0,t.pi)((0,t.pi)({},k),{variables:p(e,r,g).variables,client:m,called:!0,previousData:j.current.previousData}),y)}function p(e,r,n){var a;void 0===r&&(r={});var s=r.skip,o=(r.ssr,r.onCompleted,r.onError,r.displayName,(0,t._T)(r,["skip","ssr","onCompleted","onError","displayName"])),l=(0,t.pi)({query:e},o);return n&&(l=(0,i.J)(n,l)),s?l.fetchPolicy="standby":(!(null===(a=l.context)||void 0===a?void 0:a.renderPromises)||"network-only"!==l.fetchPolicy&&"cache-and-network"!==l.fetchPolicy)&&l.fetchPolicy||(l.fetchPolicy="cache-first"),l.variables||(l.variables={}),l}}}]);
//# sourceMappingURL=154.2ba9656f.chunk.js.map